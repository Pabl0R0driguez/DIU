{"ast":null,"code":"import _toConsumableArray from\"/media/pablo/137624ed-270b-478a-b945-4e982e255fb2/pablo/DIU/2TRIMESTRE/ProyectoFinal2T/FrontAgendav2(Final)/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _defineProperty from\"/media/pablo/137624ed-270b-478a-b945-4e982e255fb2/pablo/DIU/2TRIMESTRE/ProyectoFinal2T/FrontAgendav2(Final)/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/media/pablo/137624ed-270b-478a-b945-4e982e255fb2/pablo/DIU/2TRIMESTRE/ProyectoFinal2T/FrontAgendav2(Final)/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/media/pablo/137624ed-270b-478a-b945-4e982e255fb2/pablo/DIU/2TRIMESTRE/ProyectoFinal2T/FrontAgendav2(Final)/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import AgendaDataService from'../services/agenda.service';import TutorialDataService from'../services/tutorial.service';import{useHistory,useLocation}from'react-router-dom';import{Modal,ListGroup,Form,Button,Container,Col,Row,Card}from'react-bootstrap';import'../styles/Añadir-Editar.css';function EditPersona(){var _location$state;var id=window.location.pathname.split('/')[2];var history=useHistory();var location=useLocation();var updatePersonaInList=(_location$state=location.state)===null||_location$state===void 0?void 0:_location$state.updatePersonaInList;var _useState=useState({id:id,nombre:'',apellido:'',direccion:'',codigoPostal:'',ciudad:'',fechaNacimiento:'',tutoriales:[]// Guardaremos los títulos de los tutoriales\n}),_useState2=_slicedToArray(_useState,2),persona=_useState2[0],setPersona=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),availableTutorials=_useState4[0],setAvailableTutorials=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),selectedTutorials=_useState6[0],setSelectedTutorials=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),showTutorialModal=_useState8[0],setShowTutorialModal=_useState8[1];useEffect(function(){TutorialDataService.getAllTutorials().then(function(response){return setAvailableTutorials(response.data);}).catch(function(error){return console.error('Error al cargar tutoriales:',error);});AgendaDataService.getPersona(id).then(function(response){setPersona(response.data);// Al obtener la persona, cargamos los nombres de los tutoriales\nsetSelectedTutorials(response.data.tutoriales||[]);}).catch(function(error){return console.error(\"Error al obtener la persona:\",error);});},[id]);var editPersona=function editPersona(e){e.preventDefault();// Guardamos solo los títulos de los tutoriales seleccionados\nvar personaData=_objectSpread({},persona,{tutoriales:selectedTutorials});AgendaDataService.updatePersona(id,personaData).then(function(){if(updatePersonaInList)updatePersonaInList(personaData);history.push(\"/\");}).catch(function(error){return console.error(\"Error al actualizar la persona:\",error);});};var handleChange=function handleChange(e){var _e$target=e.target,name=_e$target.name,value=_e$target.value;setPersona(_objectSpread({},persona,_defineProperty({},name,value)));};var toggleTutorialSelection=function toggleTutorialSelection(tutorialId){var tutorial=availableTutorials.find(function(tut){return tut.id===tutorialId;});if(tutorial){if(selectedTutorials.includes(tutorial.title)){setSelectedTutorials(selectedTutorials.filter(function(title){return title!==tutorial.title;}));// Filtramos por título\n}else{setSelectedTutorials([].concat(_toConsumableArray(selectedTutorials),[tutorial.title]));// Añadimos el título\n}}};// Función para manejar el cambio en el campo de código postal\nvar handleCodigoPostalChange=function handleCodigoPostalChange(e){// Permitimos solo números y que la longitud no sea mayor a 5\nvar value=e.target.value;// Verificamos si la entrada solo contiene números y la longitud es menor o igual a 5\nif(/^\\d*$/.test(value)&&value.length<=5){setPersona(_objectSpread({},persona,{codigoPostal:value}));}};var openTutorialModal=function openTutorialModal(){return setShowTutorialModal(true);};var closeTutorialModal=function closeTutorialModal(){return setShowTutorialModal(false);};return React.createElement(Container,{className:\"d-flex justify-content-center align-items-center\",style:{minHeight:'calc(100vh - 56px)',fontFamily:\"'Poppins', sans-serif\",marginTop:'2rem'}},React.createElement(Card,{style:{width:'100%',maxWidth:'600px',padding:'2rem',borderRadius:'20px',boxShadow:'0 10px 20px rgba(0, 0, 0, 0.1)'}},React.createElement(\"h3\",{className:\"mb-4 text-center\",style:{fontWeight:'bold',color:'#125b96'}},\"Editar Persona\"),React.createElement(Form,{onSubmit:editPersona},React.createElement(Row,{className:\"mb-4\"},React.createElement(Form.Group,{as:Col,controlId:\"nombre\"},React.createElement(Form.Label,{style:{fontWeight:'600'}},\"Nombre\"),React.createElement(Form.Control,{type:\"text\",placeholder:\"Introduce nombre\",name:\"nombre\",value:persona.nombre,onChange:handleChange,className:\"form-control-custom\"})),React.createElement(Form.Group,{as:Col,controlId:\"apellido\"},React.createElement(Form.Label,{style:{fontWeight:'600'}},\"Apellido\"),React.createElement(Form.Control,{type:\"text\",placeholder:\"Introduce apellido\",name:\"apellido\",value:persona.apellido,onChange:handleChange,className:\"form-control-custom\"}))),React.createElement(Form.Group,{controlId:\"direccion\",className:\"mb-4\"},React.createElement(Form.Label,{style:{fontWeight:'600'}},\"Direcci\\xF3n\"),React.createElement(Form.Control,{type:\"text\",placeholder:\"Introduce direcci\\xF3n\",name:\"direccion\",value:persona.direccion,onChange:handleChange,className:\"form-control-custom\"})),React.createElement(Row,{className:\"mb-4\"},React.createElement(Form.Group,{as:Col,controlId:\"codigoPostal\"},React.createElement(Form.Label,{style:{fontWeight:'600'}},\"C\\xF3digo Postal\"),React.createElement(Form.Control,{type:\"text\",placeholder:\"Introduce c\\xF3digo postal\",name:\"codigoPostal\",value:persona.codigoPostal,onChange:function onChange(e){return handleCodigoPostalChange(e);}// Llamada al nuevo manejador\n,className:\"form-control-custom\"})),React.createElement(Form.Group,{as:Col,controlId:\"ciudad\"},React.createElement(Form.Label,{style:{fontWeight:'600'}},\"Ciudad\"),React.createElement(Form.Control,{type:\"text\",placeholder:\"Introduce ciudad\",name:\"ciudad\",value:persona.ciudad,onChange:handleChange,className:\"form-control-custom\"}))),React.createElement(Form.Group,{controlId:\"fechaNacimiento\",className:\"mb-4\"},React.createElement(Form.Label,{style:{fontWeight:'600'}},\"Fecha de Nacimiento\"),React.createElement(Form.Control,{type:\"date\",name:\"fechaNacimiento\",value:persona.fechaNacimiento,onChange:handleChange,className:\"form-control-custom\"})),React.createElement(Form.Group,{className:\"mb-4\"},React.createElement(Form.Label,{style:{fontWeight:'600'}},\"Tutoriales asignados\"),React.createElement(\"div\",null,selectedTutorials.length>0?\"Seleccionados: \".concat(selectedTutorials.join(\", \")):\"Ningún tutorial seleccionado\"),React.createElement(Button,{className:\"button-custom mt-2\",onClick:openTutorialModal},\"Seleccionar Tutoriales\")),React.createElement(Button,{variant:\"primary\",type:\"submit\",className:\"w-100\",style:{borderRadius:'10px',fontWeight:'600',padding:'12px',fontSize:'1rem',backgroundColor:'#125b96',borderColor:'#125b96',transition:'all 0.3s ease'},onMouseEnter:function onMouseEnter(e){return e.target.style.backgroundColor='#007bff';},onMouseLeave:function onMouseLeave(e){return e.target.style.backgroundColor='#125b96';}},\"Actualizar\"))),React.createElement(Modal,{show:showTutorialModal,onHide:closeTutorialModal,centered:true},React.createElement(Modal.Header,{closeButton:true},React.createElement(Modal.Title,null,\"Seleccionar Tutoriales\")),React.createElement(Modal.Body,null,React.createElement(\"div\",{className:\"tutorials-grid\"},availableTutorials.map(function(tutorial){return React.createElement(\"div\",{key:tutorial.id,className:\"tutorial-card \".concat(selectedTutorials.some(function(tut){return tut.id===tutorial.id;})?\"selected\":\"\"),onClick:function onClick(){return toggleTutorialSelection(tutorial.id);}},React.createElement(\"img\",{src:tutorial.url||\"https://via.placeholder.com/80\",alt:tutorial.title,className:\"tutorial-img\"}),React.createElement(\"div\",null,React.createElement(\"h5\",{className:\"tutorial-title\"},tutorial.title),React.createElement(\"p\",{className:\"tutorial-description\"},tutorial.description||\"Sin descripción\")));}))),React.createElement(Modal.Footer,null,React.createElement(Button,{className:\"confirm-button\",onClick:closeTutorialModal},\"Confirmar selecci\\xF3n\"))));}export default EditPersona;","map":{"version":3,"sources":["/media/pablo/137624ed-270b-478a-b945-4e982e255fb2/pablo/DIU/2TRIMESTRE/ProyectoFinal2T/FrontAgendav2(Final)/src/components/Editar.js"],"names":["React","useEffect","useState","AgendaDataService","TutorialDataService","useHistory","useLocation","Modal","ListGroup","Form","Button","Container","Col","Row","Card","EditPersona","id","window","location","pathname","split","history","updatePersonaInList","state","nombre","apellido","direccion","codigoPostal","ciudad","fechaNacimiento","tutoriales","persona","setPersona","availableTutorials","setAvailableTutorials","selectedTutorials","setSelectedTutorials","showTutorialModal","setShowTutorialModal","getAllTutorials","then","response","data","catch","error","console","getPersona","editPersona","e","preventDefault","personaData","updatePersona","push","handleChange","target","name","value","toggleTutorialSelection","tutorialId","tutorial","find","tut","includes","title","filter","handleCodigoPostalChange","test","length","openTutorialModal","closeTutorialModal","minHeight","fontFamily","marginTop","width","maxWidth","padding","borderRadius","boxShadow","fontWeight","color","join","fontSize","backgroundColor","borderColor","transition","style","map","some","url","description"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport AgendaDataService from '../services/agenda.service';\nimport TutorialDataService from '../services/tutorial.service';\nimport { useHistory, useLocation } from 'react-router-dom';\nimport { Modal, ListGroup, Form, Button, Container, Col, Row, Card } from 'react-bootstrap';\nimport '../styles/Añadir-Editar.css';\n\nfunction EditPersona() {\n  const id = window.location.pathname.split('/')[2];\n  const history = useHistory();\n  const location = useLocation();\n  const updatePersonaInList = location.state?.updatePersonaInList;\n\n  const [persona, setPersona] = useState({\n    id: id,\n    nombre: '',\n    apellido: '',\n    direccion: '',\n    codigoPostal: '',\n    ciudad: '',\n    fechaNacimiento: '',\n    tutoriales: [] // Guardaremos los títulos de los tutoriales\n  });\n\n  const [availableTutorials, setAvailableTutorials] = useState([]);\n  const [selectedTutorials, setSelectedTutorials] = useState([]);\n  const [showTutorialModal, setShowTutorialModal] = useState(false);\n\n  useEffect(() => {\n    TutorialDataService.getAllTutorials()\n      .then(response => setAvailableTutorials(response.data))\n      .catch(error => console.error('Error al cargar tutoriales:', error));\n\n    AgendaDataService.getPersona(id)\n      .then(response => {\n        setPersona(response.data);\n        // Al obtener la persona, cargamos los nombres de los tutoriales\n        setSelectedTutorials(response.data.tutoriales || []);\n      })\n      .catch(error => console.error(\"Error al obtener la persona:\", error));\n  }, [id]);\n\n  const editPersona = (e) => {\n    e.preventDefault();\n    // Guardamos solo los títulos de los tutoriales seleccionados\n    const personaData = { ...persona, tutoriales: selectedTutorials };\n    AgendaDataService.updatePersona(id, personaData)\n      .then(() => {\n        if (updatePersonaInList) updatePersonaInList(personaData);\n        history.push(\"/\");\n      })\n      .catch(error => console.error(\"Error al actualizar la persona:\", error));\n  };\n\n  const handleChange = (e) => {\n    const { name, value } = e.target;\n    setPersona({\n      ...persona,\n      [name]: value,\n    });\n  };\n\n  const toggleTutorialSelection = (tutorialId) => {\n    const tutorial = availableTutorials.find(tut => tut.id === tutorialId);\n\n    if (tutorial) {\n      if (selectedTutorials.includes(tutorial.title)) {\n        setSelectedTutorials(selectedTutorials.filter(title => title !== tutorial.title)); // Filtramos por título\n      } else {\n        setSelectedTutorials([...selectedTutorials, tutorial.title]); // Añadimos el título\n      }\n    }\n  };\n\n        // Función para manejar el cambio en el campo de código postal\n    const handleCodigoPostalChange = (e) => {\n      // Permitimos solo números y que la longitud no sea mayor a 5\n      const value = e.target.value;\n\n      // Verificamos si la entrada solo contiene números y la longitud es menor o igual a 5\n      if (/^\\d*$/.test(value) && value.length <= 5) {\n        setPersona({ ...persona, codigoPostal: value });\n      }\n    };\n\n\n  const openTutorialModal = () => setShowTutorialModal(true);\n  const closeTutorialModal = () => setShowTutorialModal(false);\n\n  return (\n    <Container className=\"d-flex justify-content-center align-items-center\" style={{ minHeight: 'calc(100vh - 56px)', fontFamily: \"'Poppins', sans-serif\", marginTop: '2rem' }}>\n      <Card style={{ width: '100%', maxWidth: '600px', padding: '2rem', borderRadius: '20px', boxShadow: '0 10px 20px rgba(0, 0, 0, 0.1)' }}>\n        <h3 className=\"mb-4 text-center\" style={{ fontWeight: 'bold', color: '#125b96' }}>Editar Persona</h3>\n        <Form onSubmit={editPersona}>\n          <Row className=\"mb-4\">\n            <Form.Group as={Col} controlId=\"nombre\">\n              <Form.Label style={{ fontWeight: '600' }}>Nombre</Form.Label>\n              <Form.Control\n                type=\"text\"\n                placeholder=\"Introduce nombre\"\n                name=\"nombre\"\n                value={persona.nombre}\n                onChange={handleChange}\n                className=\"form-control-custom\"\n              />\n            </Form.Group>\n            <Form.Group as={Col} controlId=\"apellido\">\n              <Form.Label style={{ fontWeight: '600' }}>Apellido</Form.Label>\n              <Form.Control\n                type=\"text\"\n                placeholder=\"Introduce apellido\"\n                name=\"apellido\"\n                value={persona.apellido}\n                onChange={handleChange}\n                className=\"form-control-custom\"\n              />\n            </Form.Group>\n          </Row>\n\n          <Form.Group controlId=\"direccion\" className=\"mb-4\">\n            <Form.Label style={{ fontWeight: '600' }}>Dirección</Form.Label>\n            <Form.Control\n              type=\"text\"\n              placeholder=\"Introduce dirección\"\n              name=\"direccion\"\n              value={persona.direccion}\n              onChange={handleChange}\n              className=\"form-control-custom\"\n            />\n          </Form.Group>\n\n          <Row className=\"mb-4\">\n            <Form.Group as={Col} controlId=\"codigoPostal\">\n              <Form.Label style={{ fontWeight: '600' }}>Código Postal</Form.Label>\n              <Form.Control\n                type=\"text\"\n                placeholder=\"Introduce código postal\"\n                name=\"codigoPostal\"\n                value={persona.codigoPostal}\n                onChange={(e) => handleCodigoPostalChange(e)} // Llamada al nuevo manejador\n                className=\"form-control-custom\"\n              />\n            </Form.Group>\n            <Form.Group as={Col} controlId=\"ciudad\">\n              <Form.Label style={{ fontWeight: '600' }}>Ciudad</Form.Label>\n              <Form.Control\n                type=\"text\"\n                placeholder=\"Introduce ciudad\"\n                name=\"ciudad\"\n                value={persona.ciudad}\n                onChange={handleChange}\n                className=\"form-control-custom\"\n              />\n            </Form.Group>\n          </Row>\n\n          <Form.Group controlId=\"fechaNacimiento\" className=\"mb-4\">\n            <Form.Label style={{ fontWeight: '600' }}>Fecha de Nacimiento</Form.Label>\n            <Form.Control\n              type=\"date\"\n              name=\"fechaNacimiento\"\n              value={persona.fechaNacimiento}\n              onChange={handleChange}\n              className=\"form-control-custom\"\n            />\n          </Form.Group>\n\n          <Form.Group className=\"mb-4\">\n            <Form.Label style={{ fontWeight: '600' }}>Tutoriales asignados</Form.Label>\n            <div>\n              {selectedTutorials.length > 0\n                ? `Seleccionados: ${selectedTutorials.join(\", \")}`\n                : \"Ningún tutorial seleccionado\"}\n            </div>\n            <Button className=\"button-custom mt-2\" onClick={openTutorialModal}>\n              Seleccionar Tutoriales\n            </Button>\n          </Form.Group>\n\n          <Button\n            variant=\"primary\"\n            type=\"submit\"\n            className=\"w-100\"\n            style={{\n              borderRadius: '10px',\n              fontWeight: '600',\n              padding: '12px',\n              fontSize: '1rem',\n              backgroundColor: '#125b96',\n              borderColor: '#125b96',\n              transition: 'all 0.3s ease',\n            }}\n            onMouseEnter={(e) => (e.target.style.backgroundColor = '#007bff')}\n            onMouseLeave={(e) => (e.target.style.backgroundColor = '#125b96')}\n          >\n            Actualizar\n          </Button>\n        </Form>\n      </Card>\n\n      <Modal show={showTutorialModal} onHide={closeTutorialModal} centered>\n             <Modal.Header closeButton>\n               <Modal.Title>Seleccionar Tutoriales</Modal.Title>\n             </Modal.Header>\n             <Modal.Body>\n               <div className=\"tutorials-grid\">\n                 {availableTutorials.map((tutorial) => (\n                   <div key={tutorial.id} className={`tutorial-card ${selectedTutorials.some(tut => tut.id === tutorial.id) ? \"selected\" : \"\"}`} onClick={() => toggleTutorialSelection(tutorial.id)}>\n                     <img src={tutorial.url || \"https://via.placeholder.com/80\"} alt={tutorial.title} className=\"tutorial-img\" />\n                     <div>\n                       <h5 className=\"tutorial-title\">{tutorial.title}</h5>\n                       <p className=\"tutorial-description\">{tutorial.description || \"Sin descripción\"}</p>\n                     </div>\n                   </div>\n                 ))}\n               </div>\n             </Modal.Body>\n             <Modal.Footer>\n               <Button className=\"confirm-button\" onClick={closeTutorialModal}>Confirmar selección</Button>\n             </Modal.Footer>\n           </Modal>\n    </Container>\n  );\n}\n\nexport default EditPersona;\n"]},"metadata":{},"sourceType":"module"}