{"ast":null,"code":"var _jsxFileName = \"/media/pablo/137624ed-270b-478a-b945-4e982e255fb2/pablo/DIU/2TRIMESTRE/ProyectoFinal2T/FrontAgendav2(Final)/src/components/Editar.js\";\nimport React, { useEffect, useState } from 'react';\nimport AgendaDataService from '../services/agenda.service';\nimport TutorialDataService from '../services/tutorial.service';\nimport { useHistory, useLocation } from 'react-router-dom';\nimport { Modal, ListGroup, Form, Button, Container, Col, Row, Card } from 'react-bootstrap';\nimport '../styles/Añadir-Editar.css';\nimport { Alert } from 'react-bootstrap';\n\nfunction EditPersona() {\n  var _location$state;\n\n  const id = window.location.pathname.split('/')[2];\n  const history = useHistory();\n  const location = useLocation();\n  const updatePersonaInList = (_location$state = location.state) === null || _location$state === void 0 ? void 0 : _location$state.updatePersonaInList;\n  const [persona, setPersona] = useState({\n    id: id,\n    nombre: '',\n    apellido: '',\n    direccion: '',\n    codigoPostal: '',\n    ciudad: '',\n    fechaNacimiento: '',\n    tutoriales: [] // Guardaremos los ids de los tutoriales\n\n  });\n  const [availableTutorials, setAvailableTutorials] = useState([]);\n  const [selectedTutorials, setSelectedTutorials] = useState([]); // Ahora almacena los ids\n\n  const [showTutorialModal, setShowTutorialModal] = useState(false);\n  const [errorMessage, setErrorMessage] = useState('');\n  useEffect(() => {\n    // Cargar todos los tutoriales disponibles\n    TutorialDataService.getAllTutorials().then(response => setAvailableTutorials(response.data)).catch(error => console.error('Error al cargar tutoriales:', error)); // Cargar la persona y sus tutoriales asignados\n\n    AgendaDataService.getPersona(id).then(response => {\n      setPersona(response.data); // Al obtener la persona, cargamos los ids de los tutoriales asignados\n\n      setSelectedTutorials(response.data.tutoriales.map(tut => tut.id) || []);\n    }).catch(error => console.error(\"Error al obtener la persona:\", error));\n  }, [id]);\n\n  const editPersona = e => {\n    e.preventDefault(); // Verifica si algún campo requerido está vacío\n\n    if (!persona.nombre || !persona.apellido || !persona.direccion || !persona.codigoPostal || !persona.ciudad || !persona.fechaNacimiento) {\n      setErrorMessage(\"Error: Todos los campos son obligatorios.\");\n      return; // Detiene la ejecución si algún campo está vacío\n    } // Guardamos solo los ids de los tutoriales seleccionados\n\n\n    const personaData = { ...persona,\n      tutoriales: selectedTutorials\n    };\n    AgendaDataService.updatePersona(id, personaData).then(() => {\n      if (updatePersonaInList) updatePersonaInList(personaData);\n      history.push(\"/\");\n    }).catch(error => console.error(\"Error al actualizar la persona:\", error));\n  };\n\n  const handleChange = e => {\n    const {\n      name,\n      value\n    } = e.target;\n    setPersona({ ...persona,\n      [name]: value\n    });\n  };\n\n  const toggleTutorialSelection = tutorialId => {\n    if (selectedTutorials.includes(tutorialId)) {\n      setSelectedTutorials(selectedTutorials.filter(id => id !== tutorialId)); // Eliminamos el tutorial si está seleccionado\n    } else {\n      setSelectedTutorials([...selectedTutorials, tutorialId]); // Agregamos el tutorial si no está seleccionado\n    }\n  };\n\n  const openTutorialModal = () => setShowTutorialModal(true);\n\n  const closeTutorialModal = () => setShowTutorialModal(false);\n\n  return React.createElement(Container, {\n    className: \"contenedor-formulario\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86\n    },\n    __self: this\n  }, React.createElement(Card, {\n    className: \"formulario-card\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87\n    },\n    __self: this\n  }, React.createElement(\"h3\", {\n    className: \"titulo-formulario\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88\n    },\n    __self: this\n  }, \"Editar Persona\"), React.createElement(Form, {\n    onSubmit: editPersona,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89\n    },\n    __self: this\n  }, React.createElement(Row, {\n    className: \"mb-4\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91\n    },\n    __self: this\n  }, React.createElement(Form.Group, {\n    as: Col,\n    controlId: \"nombre\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92\n    },\n    __self: this\n  }, React.createElement(Form.Label, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93\n    },\n    __self: this\n  }, \"Nombre\"), React.createElement(Form.Control, {\n    type: \"text\",\n    placeholder: \"Introduce nombre\",\n    name: \"nombre\",\n    value: persona.nombre,\n    onChange: handleChange,\n    className: \"form-control-custom\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94\n    },\n    __self: this\n  })), React.createElement(Form.Group, {\n    as: Col,\n    controlId: \"apellido\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103\n    },\n    __self: this\n  }, React.createElement(Form.Label, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104\n    },\n    __self: this\n  }, \"Apellido\"), React.createElement(Form.Control, {\n    type: \"text\",\n    placeholder: \"Introduce apellido\",\n    name: \"apellido\",\n    value: persona.apellido,\n    onChange: handleChange,\n    className: \"form-control-custom\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105\n    },\n    __self: this\n  }))), React.createElement(Form.Group, {\n    controlId: \"direccion\",\n    className: \"mb-4\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117\n    },\n    __self: this\n  }, React.createElement(Form.Label, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118\n    },\n    __self: this\n  }, \"Direcci\\xF3n\"), React.createElement(Form.Control, {\n    type: \"text\",\n    placeholder: \"Introduce direcci\\xF3n\",\n    name: \"direccion\",\n    value: persona.direccion,\n    onChange: handleChange,\n    className: \"form-control-custom\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119\n    },\n    __self: this\n  })), React.createElement(Row, {\n    className: \"mb-4\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129\n    },\n    __self: this\n  }, React.createElement(Form.Group, {\n    as: Col,\n    controlId: \"codigoPostal\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130\n    },\n    __self: this\n  }, React.createElement(Form.Label, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131\n    },\n    __self: this\n  }, \"C\\xF3digo Postal\"), React.createElement(Form.Control, {\n    type: \"text\",\n    placeholder: \"Introduce c\\xF3digo postal\",\n    name: \"codigoPostal\",\n    value: persona.codigoPostal,\n    onChange: handleChange,\n    className: \"form-control-custom\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132\n    },\n    __self: this\n  })), React.createElement(Form.Group, {\n    as: Col,\n    controlId: \"ciudad\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141\n    },\n    __self: this\n  }, React.createElement(Form.Label, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142\n    },\n    __self: this\n  }, \"Ciudad\"), React.createElement(Form.Control, {\n    type: \"text\",\n    placeholder: \"Introduce ciudad\",\n    name: \"ciudad\",\n    value: persona.ciudad,\n    onChange: handleChange,\n    className: \"form-control-custom\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143\n    },\n    __self: this\n  }))), React.createElement(Form.Group, {\n    controlId: \"fechaNacimiento\",\n    className: \"mb-4\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154\n    },\n    __self: this\n  }, React.createElement(Form.Label, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155\n    },\n    __self: this\n  }, \"Fecha de Nacimiento\"), React.createElement(Form.Control, {\n    type: \"date\",\n    name: \"fechaNacimiento\",\n    value: persona.fechaNacimiento,\n    onChange: handleChange,\n    className: \"form-control-custom\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156\n    },\n    __self: this\n  })), React.createElement(Form.Group, {\n    className: \"mb-4\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166\n    },\n    __self: this\n  }, React.createElement(Form.Label, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167\n    },\n    __self: this\n  }, \"Tutoriales asignados\"), React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168\n    },\n    __self: this\n  }, selectedTutorials.length > 0 ? `Seleccionados: ${selectedTutorials.map(id => {\n    const tutorial = availableTutorials.find(tut => tut.id === id);\n    return tutorial ? tutorial.title : 'Desconocido';\n  }).join(\", \")}` : \"Ningún tutorial seleccionado\"), React.createElement(Button, {\n    className: \"button-custom mt-2\",\n    onClick: openTutorialModal,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176\n    },\n    __self: this\n  }, \"Seleccionar Tutoriales\")), React.createElement(Button, {\n    variant: \"primary\",\n    type: \"submit\",\n    className: \"boton-enviar\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181\n    },\n    __self: this\n  }, \"Actualizar\"), errorMessage && React.createElement(Alert, {\n    variant: \"danger\",\n    className: \"mt-4\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 191\n    },\n    __self: this\n  }, React.createElement(\"strong\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192\n    },\n    __self: this\n  }, errorMessage)))), React.createElement(Modal, {\n    show: showTutorialModal,\n    onHide: closeTutorialModal,\n    centered: true,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 199\n    },\n    __self: this\n  }, React.createElement(Modal.Header, {\n    closeButton: true,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 200\n    },\n    __self: this\n  }, React.createElement(Modal.Title, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 201\n    },\n    __self: this\n  }, \"Seleccionar Tutoriales\")), React.createElement(Modal.Body, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 203\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"tutorials-grid\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 204\n    },\n    __self: this\n  }, availableTutorials.map(tutorial => React.createElement(\"div\", {\n    key: tutorial.id,\n    className: `tutorial-card ${selectedTutorials.includes(tutorial.id) ? \"selected\" : \"\"}`,\n    onClick: () => toggleTutorialSelection(tutorial.id),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 206\n    },\n    __self: this\n  }, React.createElement(\"img\", {\n    src: tutorial.url || \"https://via.placeholder.com/80\" // Imagen por defecto si no hay URL\n    ,\n    alt: tutorial.title,\n    className: \"tutorial-img\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 211\n    },\n    __self: this\n  }), React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 216\n    },\n    __self: this\n  }, React.createElement(\"h5\", {\n    className: \"tutorial-title\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 217\n    },\n    __self: this\n  }, tutorial.title), React.createElement(\"p\", {\n    className: \"tutorial-description\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 218\n    },\n    __self: this\n  }, tutorial.description || \"Sin descripción\")))))), React.createElement(Modal.Footer, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 224\n    },\n    __self: this\n  }, React.createElement(Button, {\n    className: \"confirm-button\",\n    onClick: closeTutorialModal,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 225\n    },\n    __self: this\n  }, \"Confirmar selecci\\xF3n\"))));\n}\n\nexport default EditPersona;","map":{"version":3,"sources":["/media/pablo/137624ed-270b-478a-b945-4e982e255fb2/pablo/DIU/2TRIMESTRE/ProyectoFinal2T/FrontAgendav2(Final)/src/components/Editar.js"],"names":["React","useEffect","useState","AgendaDataService","TutorialDataService","useHistory","useLocation","Modal","ListGroup","Form","Button","Container","Col","Row","Card","Alert","EditPersona","id","window","location","pathname","split","history","updatePersonaInList","state","persona","setPersona","nombre","apellido","direccion","codigoPostal","ciudad","fechaNacimiento","tutoriales","availableTutorials","setAvailableTutorials","selectedTutorials","setSelectedTutorials","showTutorialModal","setShowTutorialModal","errorMessage","setErrorMessage","getAllTutorials","then","response","data","catch","error","console","getPersona","map","tut","editPersona","e","preventDefault","personaData","updatePersona","push","handleChange","name","value","target","toggleTutorialSelection","tutorialId","includes","filter","openTutorialModal","closeTutorialModal","length","tutorial","find","title","join","url","description"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport AgendaDataService from '../services/agenda.service';\nimport TutorialDataService from '../services/tutorial.service';\nimport { useHistory, useLocation } from 'react-router-dom';\nimport { Modal, ListGroup, Form, Button, Container, Col, Row, Card } from 'react-bootstrap';\nimport '../styles/Añadir-Editar.css';\nimport { Alert } from 'react-bootstrap';\n\nfunction EditPersona() {\n  const id = window.location.pathname.split('/')[2];\n  const history = useHistory();\n  const location = useLocation();\n  const updatePersonaInList = location.state?.updatePersonaInList;\n\n  const [persona, setPersona] = useState({\n    id: id,\n    nombre: '',\n    apellido: '',\n    direccion: '',\n    codigoPostal: '',\n    ciudad: '',\n    fechaNacimiento: '',\n    tutoriales: [] // Guardaremos los ids de los tutoriales\n  });\n\n  const [availableTutorials, setAvailableTutorials] = useState([]);\n  const [selectedTutorials, setSelectedTutorials] = useState([]); // Ahora almacena los ids\n  const [showTutorialModal, setShowTutorialModal] = useState(false);\n  const [errorMessage, setErrorMessage] = useState('');\n\n  useEffect(() => {\n    // Cargar todos los tutoriales disponibles\n    TutorialDataService.getAllTutorials()\n      .then(response => setAvailableTutorials(response.data))\n      .catch(error => console.error('Error al cargar tutoriales:', error));\n\n    // Cargar la persona y sus tutoriales asignados\n    AgendaDataService.getPersona(id)\n      .then(response => {\n        setPersona(response.data);\n        // Al obtener la persona, cargamos los ids de los tutoriales asignados\n        setSelectedTutorials(response.data.tutoriales.map(tut => tut.id) || []);\n      })\n      .catch(error => console.error(\"Error al obtener la persona:\", error));\n  }, [id]);\n\n  const editPersona = (e) => {\n    e.preventDefault();\n\n    // Verifica si algún campo requerido está vacío\n    if (!persona.nombre || !persona.apellido || !persona.direccion || !persona.codigoPostal || !persona.ciudad || !persona.fechaNacimiento) {\n      setErrorMessage(\"Error: Todos los campos son obligatorios.\");\n      return; // Detiene la ejecución si algún campo está vacío\n    }\n\n    // Guardamos solo los ids de los tutoriales seleccionados\n    const personaData = { ...persona, tutoriales: selectedTutorials };\n    AgendaDataService.updatePersona(id, personaData)\n      .then(() => {\n        if (updatePersonaInList) updatePersonaInList(personaData);\n        history.push(\"/\");\n      })\n      .catch(error => console.error(\"Error al actualizar la persona:\", error));\n  };\n\n  const handleChange = (e) => {\n    const { name, value } = e.target;\n    setPersona({\n      ...persona,\n      [name]: value,\n    });\n  };\n\n  const toggleTutorialSelection = (tutorialId) => {\n    if (selectedTutorials.includes(tutorialId)) {\n      setSelectedTutorials(selectedTutorials.filter(id => id !== tutorialId)); // Eliminamos el tutorial si está seleccionado\n    } else {\n      setSelectedTutorials([...selectedTutorials, tutorialId]); // Agregamos el tutorial si no está seleccionado\n    }\n  };\n\n  const openTutorialModal = () => setShowTutorialModal(true);\n  const closeTutorialModal = () => setShowTutorialModal(false);\n\n  return (\n    <Container className=\"contenedor-formulario\">\n      <Card className=\"formulario-card\">\n        <h3 className=\"titulo-formulario\">Editar Persona</h3>\n        <Form onSubmit={editPersona}>\n          {/* Formulario para editar persona */}\n          <Row className=\"mb-4\">\n            <Form.Group as={Col} controlId=\"nombre\">\n              <Form.Label>Nombre</Form.Label>\n              <Form.Control\n                type=\"text\"\n                placeholder=\"Introduce nombre\"\n                name=\"nombre\"\n                value={persona.nombre}\n                onChange={handleChange}\n                className=\"form-control-custom\"\n              />\n            </Form.Group>\n            <Form.Group as={Col} controlId=\"apellido\">\n              <Form.Label>Apellido</Form.Label>\n              <Form.Control\n                type=\"text\"\n                placeholder=\"Introduce apellido\"\n                name=\"apellido\"\n                value={persona.apellido}\n                onChange={handleChange}\n                className=\"form-control-custom\"\n              />\n            </Form.Group>\n          </Row>\n\n          {/* Otros campos del formulario */}\n          <Form.Group controlId=\"direccion\" className=\"mb-4\">\n            <Form.Label>Dirección</Form.Label>\n            <Form.Control\n              type=\"text\"\n              placeholder=\"Introduce dirección\"\n              name=\"direccion\"\n              value={persona.direccion}\n              onChange={handleChange}\n              className=\"form-control-custom\"\n            />\n          </Form.Group>\n\n          <Row className=\"mb-4\">\n            <Form.Group as={Col} controlId=\"codigoPostal\">\n              <Form.Label>Código Postal</Form.Label>\n              <Form.Control\n                type=\"text\"\n                placeholder=\"Introduce código postal\"\n                name=\"codigoPostal\"\n                value={persona.codigoPostal}\n                onChange={handleChange}\n                className=\"form-control-custom\"\n              />\n            </Form.Group>\n            <Form.Group as={Col} controlId=\"ciudad\">\n              <Form.Label>Ciudad</Form.Label>\n              <Form.Control\n                type=\"text\"\n                placeholder=\"Introduce ciudad\"\n                name=\"ciudad\"\n                value={persona.ciudad}\n                onChange={handleChange}\n                className=\"form-control-custom\"\n              />\n            </Form.Group>\n          </Row>\n\n          <Form.Group controlId=\"fechaNacimiento\" className=\"mb-4\">\n            <Form.Label>Fecha de Nacimiento</Form.Label>\n            <Form.Control\n              type=\"date\"\n              name=\"fechaNacimiento\"\n              value={persona.fechaNacimiento}\n              onChange={handleChange}\n              className=\"form-control-custom\"\n            />\n          </Form.Group>\n\n          {/* Mostrar tutoriales seleccionados */}\n          <Form.Group className=\"mb-4\">\n            <Form.Label>Tutoriales asignados</Form.Label>\n            <div>\n              {selectedTutorials.length > 0\n                ? `Seleccionados: ${selectedTutorials.map(id => {\n                    const tutorial = availableTutorials.find(tut => tut.id === id);\n                    return tutorial ? tutorial.title : 'Desconocido';\n                  }).join(\", \")}`\n                : \"Ningún tutorial seleccionado\"}\n            </div>\n            <Button className=\"button-custom mt-2\" onClick={openTutorialModal}>\n              Seleccionar Tutoriales\n            </Button>\n          </Form.Group>\n\n          <Button\n            variant=\"primary\"\n            type=\"submit\"\n            className=\"boton-enviar\"\n          >\n            Actualizar\n          </Button>\n\n          {/* Mostrar el mensaje de error con Alert si hay un error */}\n          {errorMessage && (\n            <Alert variant=\"danger\" className='mt-4'>\n              <strong>{errorMessage}</strong>\n            </Alert>\n          )}\n        </Form>\n      </Card>\n\n      {/* Modal para seleccionar tutoriales */}\n      <Modal show={showTutorialModal} onHide={closeTutorialModal} centered>\n        <Modal.Header closeButton>\n          <Modal.Title>Seleccionar Tutoriales</Modal.Title>\n        </Modal.Header>\n        <Modal.Body>\n          <div className=\"tutorials-grid\">\n            {availableTutorials.map((tutorial) => (\n              <div\n                key={tutorial.id}\n                className={`tutorial-card ${selectedTutorials.includes(tutorial.id) ? \"selected\" : \"\"}`}\n                onClick={() => toggleTutorialSelection(tutorial.id)}\n              >\n                <img\n                  src={tutorial.url || \"https://via.placeholder.com/80\"} // Imagen por defecto si no hay URL\n                  alt={tutorial.title}\n                  className=\"tutorial-img\"\n                />\n                <div>\n                  <h5 className=\"tutorial-title\">{tutorial.title}</h5>\n                  <p className=\"tutorial-description\">{tutorial.description || \"Sin descripción\"}</p>\n                </div>\n              </div>\n            ))}\n          </div>\n        </Modal.Body>\n        <Modal.Footer>\n          <Button className=\"confirm-button\" onClick={closeTutorialModal}>\n            Confirmar selección\n          </Button>\n        </Modal.Footer>\n      </Modal>\n    </Container>\n  );\n}\n\nexport default EditPersona;\n"]},"metadata":{},"sourceType":"module"}