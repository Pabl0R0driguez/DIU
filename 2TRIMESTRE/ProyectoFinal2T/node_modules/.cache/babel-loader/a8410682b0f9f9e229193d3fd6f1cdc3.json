{"ast":null,"code":"import _toConsumableArray from\"/media/pablo/137624ed-270b-478a-b945-4e982e255fb2/pablo/DIU/2TRIMESTRE/ProyectoFinal2T/FrontAgendav2(Final)/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _defineProperty from\"/media/pablo/137624ed-270b-478a-b945-4e982e255fb2/pablo/DIU/2TRIMESTRE/ProyectoFinal2T/FrontAgendav2(Final)/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/media/pablo/137624ed-270b-478a-b945-4e982e255fb2/pablo/DIU/2TRIMESTRE/ProyectoFinal2T/FrontAgendav2(Final)/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/media/pablo/137624ed-270b-478a-b945-4e982e255fb2/pablo/DIU/2TRIMESTRE/ProyectoFinal2T/FrontAgendav2(Final)/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import AgendaDataService from'../services/agenda.service';import TutorialDataService from'../services/tutorial.service';import'bootstrap/dist/css/bootstrap.min.css';import{useHistory}from'react-router-dom';import{Form,Button,Row,Col,Container,Card,Modal}from'react-bootstrap';import{Alert}from'react-bootstrap';import\"../styles/Añadir-Editar.css\";function Añadir(){var _useState=useState({nombre:'',apellido:'',direccion:'',codigoPostal:'',ciudad:'',fechaNacimiento:'',tutoriales:[]}),_useState2=_slicedToArray(_useState,2),persona=_useState2[0],setPersona=_useState2[1];// Objeto que almacena los datos de la persona\nvar _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),availableTutorials=_useState4[0],setAvailableTutorials=_useState4[1];// Lista de tutoriales disponibles para la persona\nvar _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),selectedTutorials=_useState6[0],setSelectedTutorials=_useState6[1];// Tutoriales seleccionados\nvar _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),showTutorialModal=_useState8[0],setShowTutorialModal=_useState8[1];// Controla la visibilidad del modal para seleccioanar tutoriales\nvar history=useHistory();var _useState9=useState(''),_useState10=_slicedToArray(_useState9,2),errorMessage=_useState10[0],setErrorMessage=_useState10[1];// Se ejecuta el montar el componente, mostramos lista de todos los tutoriales disponibles\n// Los guardamos en availableTutorials\nuseEffect(function(){TutorialDataService.getAllTutorials().then(function(response){setAvailableTutorials(response.data);}).catch(function(error){console.error('Error al cargar tutoriales:',error);});},[]);var agregarPersona=function agregarPersona(e){e.preventDefault();// Verifica si algún campo requerido está vacío\nif(!persona.nombre||!persona.apellido||!persona.direccion||!persona.codigoPostal||!persona.ciudad||!persona.fechaNacimiento){setErrorMessage(\"Error: Todos los campos son obligatorios.\");return;// Detiene la ejecución si algún campo está vacío\n}var personaData=_objectSpread({},persona,{tutoriales:selectedTutorials.map(function(tut){return tut.title;})});// Si la fecha de nacimiento ya fue validada, podemos proceder\nAgendaDataService.createPersona(personaData).then(function(response){history.push(\"/\");// Redirige a la página principal\nconsole.log('Persona agregada:',response.data);}).catch(function(error){console.error('Error al agregar persona:',error);});};var handleChange=function handleChange(e){var _e$target=e.target,name=_e$target.name,value=_e$target.value;setPersona(_objectSpread({},persona,_defineProperty({},name,value)));};var toggleTutorialSelection=function toggleTutorialSelection(tutorialId){var tutorial=availableTutorials.find(function(tut){return tut.id===tutorialId;});if(tutorial){if(selectedTutorials.some(function(tut){return tut.id===tutorialId;})){setSelectedTutorials(selectedTutorials.filter(function(tut){return tut.id!==tutorialId;}));}else{setSelectedTutorials([].concat(_toConsumableArray(selectedTutorials),[tutorial]));}}};// Función para manejar el cambio en el campo de código postal\nvar handleCodigoPostalChange=function handleCodigoPostalChange(e){// Permitimos solo números y que la longitud no sea mayor a 5\nvar value=e.target.value;// Verificamos si la entrada solo contiene números y la longitud es menor o igual a 5\nif(/^\\d*$/.test(value)&&value.length<=5){setPersona(_objectSpread({},persona,{codigoPostal:value}));}};var openTutorialModal=function openTutorialModal(){return setShowTutorialModal(true);};var closeTutorialModal=function closeTutorialModal(){return setShowTutorialModal(false);};return React.createElement(Container,{className:\"contenedor-formulario\"},React.createElement(Card,{className:\"formulario-card\"},React.createElement(\"h3\",{className:\"titulo-formulario\"},\"A\\xF1adir Persona\"),React.createElement(Form,{onSubmit:agregarPersona},React.createElement(Row,{className:\"mb-4\"},React.createElement(Form.Group,{as:Col,controlId:\"nombre\"},React.createElement(Form.Label,null,\"Nombre\"),React.createElement(Form.Control,{type:\"text\",placeholder:\"Introduce nombre\",name:\"nombre\",value:persona.nombre,onChange:handleChange,className:\"form-control-custom\"})),React.createElement(Form.Group,{as:Col,controlId:\"apellido\"},React.createElement(Form.Label,null,\"Apellido\"),React.createElement(Form.Control,{type:\"text\",placeholder:\"Introduce apellido\",name:\"apellido\",value:persona.apellido,onChange:handleChange,className:\"form-control-custom\"}))),React.createElement(Form.Group,{controlId:\"direccion\",className:\"mb-4\"},React.createElement(Form.Label,null,\"Direcci\\xF3n\"),React.createElement(Form.Control,{type:\"text\",placeholder:\"Introduce direcci\\xF3n\",name:\"direccion\",value:persona.direccion,onChange:handleChange,className:\"form-control-custom\"})),React.createElement(Row,{className:\"mb-4\"},React.createElement(Form.Group,{as:Col,controlId:\"codigoPostal\"},React.createElement(Form.Label,null,\"C\\xF3digo Postal\"),React.createElement(Form.Control,{type:\"text\",placeholder:\"Introduce c\\xF3digo postal\",name:\"codigoPostal\",value:persona.codigoPostal,onChange:function onChange(e){return handleCodigoPostalChange(e);}// Llamada al nuevo manejador\n,className:\"form-control-custom\"})),React.createElement(Form.Group,{as:Col,controlId:\"ciudad\"},React.createElement(Form.Label,null,\"Ciudad\"),React.createElement(Form.Control,{type:\"text\",placeholder:\"Introduce ciudad\",name:\"ciudad\",value:persona.ciudad,onChange:handleChange,className:\"form-control-custom\"}))),React.createElement(Form.Group,{controlId:\"fechaNacimiento\",className:\"mb-4\"},React.createElement(Form.Label,null,\"Fecha de Nacimiento\"),React.createElement(Form.Control,{type:\"date\",name:\"fechaNacimiento\",value:persona.fechaNacimiento,onChange:handleChange,className:\"form-control-custom\"})),React.createElement(Form.Group,{className:\"mb-4\"},React.createElement(Form.Label,null,\"Tutoriales asignados\"),React.createElement(\"div\",null,selectedTutorials.length>0?\"Seleccionados: \".concat(selectedTutorials.map(function(tut){return tut.title;}).join(\", \")):\"Ningún tutorial seleccionado\"),React.createElement(Button,{className:\"button-custom mt-2\",onClick:openTutorialModal},\"Seleccionar Tutoriales\")),React.createElement(Button,{type:\"submit\",className:\"boton-enviar\"},\"A\\xF1adir\"),errorMessage&&React.createElement(Alert,{variant:\"danger\",className:\"mt-4\"},React.createElement(\"strong\",null,errorMessage)))),React.createElement(Modal,{show:showTutorialModal,onHide:closeTutorialModal,centered:true},React.createElement(Modal.Header,{closeButton:true},React.createElement(Modal.Title,null,\"Seleccionar Tutoriales\")),React.createElement(Modal.Body,null,React.createElement(\"div\",{className:\"tutorials-grid\"},availableTutorials.map(function(tutorial){return React.createElement(\"div\",{key:tutorial.id,className:\"tutorial-card \".concat(selectedTutorials.some(function(tut){return tut.id===tutorial.id;})?\"selected\":\"\"),onClick:function onClick(){return toggleTutorialSelection(tutorial.id);}},React.createElement(\"img\",{src:tutorial.url||\"https://via.placeholder.com/80\",alt:tutorial.title,className:\"tutorial-img\"}),React.createElement(\"div\",null,React.createElement(\"h5\",{className:\"tutorial-title\"},tutorial.title),React.createElement(\"p\",{className:\"tutorial-description\"},tutorial.description||\"Sin descripción\")));}))),React.createElement(Modal.Footer,null,React.createElement(Button,{className:\"confirm-button\",onClick:closeTutorialModal},\"Confirmar selecci\\xF3n\"))));}export default Añadir;","map":{"version":3,"sources":["/media/pablo/137624ed-270b-478a-b945-4e982e255fb2/pablo/DIU/2TRIMESTRE/ProyectoFinal2T/FrontAgendav2(Final)/src/components/Añadir.js"],"names":["React","useState","useEffect","AgendaDataService","TutorialDataService","useHistory","Form","Button","Row","Col","Container","Card","Modal","Alert","Añadir","nombre","apellido","direccion","codigoPostal","ciudad","fechaNacimiento","tutoriales","persona","setPersona","availableTutorials","setAvailableTutorials","selectedTutorials","setSelectedTutorials","showTutorialModal","setShowTutorialModal","history","errorMessage","setErrorMessage","getAllTutorials","then","response","data","catch","error","console","agregarPersona","e","preventDefault","personaData","map","tut","title","createPersona","push","log","handleChange","target","name","value","toggleTutorialSelection","tutorialId","tutorial","find","id","some","filter","handleCodigoPostalChange","test","length","openTutorialModal","closeTutorialModal","join","url","description"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport AgendaDataService from '../services/agenda.service';\nimport TutorialDataService from '../services/tutorial.service';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport { useHistory } from 'react-router-dom';\nimport { Form, Button, Row, Col, Container, Card, Modal } from 'react-bootstrap';\nimport { Alert } from 'react-bootstrap';\n\nimport \"../styles/Añadir-Editar.css\";\n\nfunction Añadir() {\n  const [persona, setPersona] = useState({\n    nombre: '',\n    apellido: '',\n    direccion: '',\n    codigoPostal: '',\n    ciudad: '',\n    fechaNacimiento: '',\n    tutoriales: []\n  }); // Objeto que almacena los datos de la persona\n\n  const [availableTutorials, setAvailableTutorials] = useState([]); // Lista de tutoriales disponibles para la persona\n  const [selectedTutorials, setSelectedTutorials] = useState([]);  // Tutoriales seleccionados\n  const [showTutorialModal, setShowTutorialModal] = useState(false); // Controla la visibilidad del modal para seleccioanar tutoriales\n  const history = useHistory();\n  const [errorMessage, setErrorMessage] = useState('');\n\n\n// Se ejecuta el montar el componente, mostramos lista de todos los tutoriales disponibles\n// Los guardamos en availableTutorials\n  useEffect(() => {\n    TutorialDataService.getAllTutorials()\n      .then((response) => {\n        setAvailableTutorials(response.data);\n      })\n      .catch((error) => {\n        console.error('Error al cargar tutoriales:', error);\n      });\n  }, []);\n\n  const agregarPersona = (e) => {\n    e.preventDefault();\n  \n    // Verifica si algún campo requerido está vacío\n    if (!persona.nombre || !persona.apellido || !persona.direccion || !persona.codigoPostal || !persona.ciudad || !persona.fechaNacimiento) {\n      setErrorMessage(\"Error: Todos los campos son obligatorios.\");\n      return; // Detiene la ejecución si algún campo está vacío\n    }\n  \n    const personaData = { ...persona, tutoriales: selectedTutorials.map(tut => tut.title) };\n  \n    // Si la fecha de nacimiento ya fue validada, podemos proceder\n    AgendaDataService.createPersona(personaData)\n      .then((response) => {\n        history.push(\"/\"); // Redirige a la página principal\n        console.log('Persona agregada:', response.data);\n      })\n      .catch((error) => {\n        console.error('Error al agregar persona:', error);\n      });\n  };\n\n  \n  const handleChange = (e) => {\n    const { name, value } = e.target;\n    setPersona({ ...persona, [name]: value });\n  };\n\n  const toggleTutorialSelection = (tutorialId) => {\n    const tutorial = availableTutorials.find(tut => tut.id === tutorialId);\n    if (tutorial) {\n      if (selectedTutorials.some(tut => tut.id === tutorialId)) {\n        setSelectedTutorials(selectedTutorials.filter(tut => tut.id !== tutorialId));\n      } else {\n        setSelectedTutorials([...selectedTutorials, tutorial]);\n      }\n    }\n  };\n\n  // Función para manejar el cambio en el campo de código postal\n  const handleCodigoPostalChange = (e) => {\n    // Permitimos solo números y que la longitud no sea mayor a 5\n    const value = e.target.value;\n\n    // Verificamos si la entrada solo contiene números y la longitud es menor o igual a 5\n    if (/^\\d*$/.test(value) && value.length <= 5) {\n      setPersona({ ...persona, codigoPostal: value });\n    }\n  };\n\n\n  const openTutorialModal = () => setShowTutorialModal(true);\n  const closeTutorialModal = () => setShowTutorialModal(false);\n\n  return (\n    <Container className=\"contenedor-formulario\">\n      <Card className=\"formulario-card\">\n        <h3 className=\"titulo-formulario\">Añadir Persona</h3>\n\n    \n\n        <Form onSubmit={agregarPersona}>\n          <Row className=\"mb-4\">\n            <Form.Group as={Col} controlId=\"nombre\">\n              <Form.Label>Nombre</Form.Label>\n              <Form.Control type=\"text\" placeholder=\"Introduce nombre\" name=\"nombre\" value={persona.nombre} onChange={handleChange} className=\"form-control-custom\" />\n            </Form.Group>\n            <Form.Group as={Col} controlId=\"apellido\">\n              <Form.Label>Apellido</Form.Label>\n              <Form.Control type=\"text\" placeholder=\"Introduce apellido\" name=\"apellido\" value={persona.apellido} onChange={handleChange} className=\"form-control-custom\" />\n            </Form.Group>\n          </Row>\n\n          <Form.Group controlId=\"direccion\" className=\"mb-4\">\n            <Form.Label>Dirección</Form.Label>\n            <Form.Control type=\"text\" placeholder=\"Introduce dirección\" name=\"direccion\" value={persona.direccion} onChange={handleChange} className=\"form-control-custom\" />\n          </Form.Group>\n\n          <Row className=\"mb-4\">\n          <Form.Group as={Col} controlId=\"codigoPostal\">\n              <Form.Label>Código Postal</Form.Label>\n              <Form.Control\n                type=\"text\"\n                placeholder=\"Introduce código postal\"\n                name=\"codigoPostal\"\n                value={persona.codigoPostal}\n                onChange={(e) => handleCodigoPostalChange(e)} // Llamada al nuevo manejador\n                className=\"form-control-custom\"\n              />\n            </Form.Group>\n\n            <Form.Group as={Col} controlId=\"ciudad\">\n              <Form.Label>Ciudad</Form.Label>\n              <Form.Control type=\"text\" placeholder=\"Introduce ciudad\" name=\"ciudad\" value={persona.ciudad} onChange={handleChange} className=\"form-control-custom\" />\n            </Form.Group>\n          </Row>\n\n          <Form.Group controlId=\"fechaNacimiento\" className=\"mb-4\">\n            <Form.Label>Fecha de Nacimiento</Form.Label>\n            <Form.Control type=\"date\" name=\"fechaNacimiento\" value={persona.fechaNacimiento} onChange={handleChange} className=\"form-control-custom\" />\n          </Form.Group>\n\n          <Form.Group className=\"mb-4\">\n            <Form.Label>Tutoriales asignados</Form.Label>\n            <div>{selectedTutorials.length > 0 ? `Seleccionados: ${selectedTutorials.map(tut => tut.title).join(\", \")}` : \"Ningún tutorial seleccionado\"}</div>\n            <Button className=\"button-custom mt-2\" onClick={openTutorialModal}>Seleccionar Tutoriales</Button>\n          </Form.Group>\n\n          <Button type=\"submit\" className=\"boton-enviar\">Añadir</Button>\n             {/* Mostrar el mensaje de error con Alert si hay un error */}\n             {errorMessage && (\n          <Alert variant=\"danger\" className='mt-4'>\n            <strong>{errorMessage}</strong>\n          </Alert>\n        )}\n        </Form>\n      </Card>\n\n      \n\n      <Modal show={showTutorialModal} onHide={closeTutorialModal} centered>\n        <Modal.Header closeButton>\n          <Modal.Title>Seleccionar Tutoriales</Modal.Title>\n        </Modal.Header>\n        <Modal.Body>\n          <div className=\"tutorials-grid\">\n            {availableTutorials.map((tutorial) => (\n              <div key={tutorial.id} className={`tutorial-card ${selectedTutorials.some(tut => tut.id === tutorial.id) ? \"selected\" : \"\"}`} onClick={() => toggleTutorialSelection(tutorial.id)}>\n                <img src={tutorial.url || \"https://via.placeholder.com/80\"} alt={tutorial.title} className=\"tutorial-img\" />\n                <div>\n                  <h5 className=\"tutorial-title\">{tutorial.title}</h5>\n                  <p className=\"tutorial-description\">{tutorial.description || \"Sin descripción\"}</p>\n                </div>\n              </div>\n            ))}\n          </div>\n        </Modal.Body>\n        <Modal.Footer>\n          <Button className=\"confirm-button\" onClick={closeTutorialModal}>Confirmar selección</Button>\n        </Modal.Footer>\n      </Modal>\n    </Container>\n  );\n}\n\nexport default Añadir;\n"]},"metadata":{},"sourceType":"module"}